import geopy
import pandas as pd

def get_zipcode(df, geolocator, lat_field, lon_field):
    location = geolocator.reverse((df[lat_field], df[lon_field]))
    return location.raw['address']

geolocator = geopy.Nominatim(user_agent='my-application')

df = pd.DataFrame({
    'Lat': [47.49282423,38.77357706,39.3122034,27.62859625,33.0290384,39.59552295,42.09290662,38.75242318,20.94230925,32.734364,34.64361486,44.71597962,61.9965738,45.11510223,30.63461353,34.77549,41.52134869,40.61447511,40.777596,38.48705587,38.3294325,41.93457817,47.58113919,34.64043495,42.97885674,39.04639416,44.2605176,18.42232,29.5123195,40.71554634,38.19248895,30.60091958,46.79317433,33.79784868,32.90082121,34.81195203,30.25511845,35.0898971,40.805046,33.22257529,31.44775106,33.58604473,36.85402787,27.81505127,42.84970487,42.64988854,32.75545863,40.6200378,44.23842,30.07553317,30.16566633,31.98559426,43.24247561,25.85785425,37.83205938,41.85769975,35.17071867,41.51692087,35.27058079,44.12026946,33.9134745,36.78648009,28.77009843,41.87321575,40.830782,40.249772,39.96168473,43.11438798,39.9493177,45.15519497,35.94910693,41.310326,41.66700214,36.18810932,39.65122636,26.72315091,42.9329312,35.78774565,36.08466278,41.68966298,33.24796024,40.09528919,39.99328575,36.3030365,32.14902581,41.96160036,32.22826292,38.81182638,37.10367824,37.76139657,26.49419711,37.51720888,35.34373563,44.704788,37.88020425,33.36309064,42.79359484,33.8851698,39.32448306,42.44461311,32.84590207,39.11745114,40.15466804,42.69674847,41.38330548,41.9384092,41.89701875,40.96951187,41.53965054,32.75097909,34.2276722,39.06238997,33.37248743,40.145521,40.85863987,42.32475484,38.81702767,29.69529234,26.4304351,39.45282572,37.28745928,38.56623508,38.96007485,34.39934529,34.22115485],
    'Lon': [-116.3316642,-90.38463232,-119.8179018,-80.43404137,-96.78511822,-76.66983109,-71.25464765,-104.791366,-157.3724934,-114.9980409,-82.31090841,-84.83369063,-149.3276978,-93.28948598,-87.6418072,-111.7005336,-83.505252,-74.41586108,-74.1115972,-121.3021574,-122.3957998,-88.21928845,-122.3129087,-86.5749981,-78.31031939,-95.01642832,-111.223914,-66.16284,-98.33119519,-73.67381421,-85.59805816,-97.63068818,-99.35355517,-117.8555071,-80.0975847,-80.92400556,-90.55941858,-92.2767049,-111.8822387,-84.64350271,-84.24443569,-112.1778961,-76.34778435,-82.52154388,-76.06152067,-83.10911761,-101.5792086,-79.90702084,-91.70796933,-95.0429338,-81.80660875,-106.395365,-115.763243,-80.25409807,-122.0757247,-96.4866,-106.5155912,-85.66207167,-89.71751893,-69.72332946,-118.2527093,-119.8213544,-81.29042491,-89.19596194,-75.82592418,-122.297899,-82.7777559,-73.56034896,-86.11406448,-122.6734412,-114.8877079,-81.61880422,-93.69210671,-86.69570384,-105.0158861,-98.0772565,-84.07188041,-78.90930739,-83.59616186,-72.71828814,-86.61059321,-75.27362031,-75.01771421,-94.4415989,-110.7391014,-91.23880118,-93.92538497,-77.09648385,-97.89371779,-88.38878943,-81.91988885,-77.67213338,-119.6069444,-88.681401,-108.1157188,-117.0795481,-85.85832542,-84.25638445,-84.36411218,-71.10957404,-97.19804176,-76.74136079,-74.39045107,-88.03884727,-87.71625492,-87.94974553,-87.71136957,-73.90860128,-73.99495038,-117.0714353,-117.4364951,-77.30893458,-111.8556024,-104.9582591,-72.92555841,-83.32723497,-77.29652142,-95.41811768,-80.13064695,-75.21425831,-122.0171695,-77.19283379,-76.91593446,-84.42174923,-118.4830787]
})
zipcodes = df.apply(get_zipcode, axis=1, geolocator=geolocator, lat_field='Lat', lon_field='Lon')



print(zipcodes)